#!/usr/bin/python
# -*- coding:utf-8 -*-
#author:Jumbo
#website:www.chinabaiker.com
import getopt
import sys
import domain
import dir
import appscan
import brute_pass

opts, args = getopt.getopt(sys.argv[1:], "hu:m:d:e:s:t:", ["help","url=","module=","dict=","errorkey=","save_path=","thread="])
url,module,dict,errorkey,save_path,thread="","","","","",""


def help():
    print "-h --help Show basic help message and exit"
    print "-u --url  Target URL/Appscan Id/Brute_pass url"
    print "-d --dict  Dir_Dict"
    print "-e --errorkey  Dir_errorkey"
    print "-s --save_path  Dir_save_path"
    print "-t --thread  Dir_thread"
    print "-m --module Module(Domain/Dir/Appscan/Brute_pass)"
    print "JPentest.py -m Domain -u chinabaiker.com"
    print "JPentest.py -m Dir -u https://www.chinabaiker.com -d dir.txt -s saveok.txt -e \"sorry\" -t 20"
    print "JPentest.py -m Appscan -u http://appscan.io/app-report.html?id=your appscan id"
    print "JPentest.py -m Brute_pass -u http://www.chinabaiker.com/login.php"


if len(sys.argv) < 2:
    help()



for option, value in opts:
    if option in ["-u","--url"]:
        url = value
    elif option in ["-m","--module"]:
        module = value
    elif option in ["-d","--dict"]:
        dict = value
    elif option in ["-e","--errorkey"]:
        errorkey = value
    elif option in ["-s", "--save_path"]:
        save_path = value
    elif option in ["-t", "--thread"]:
        thread = value
    elif option in ["-h","--help"]:
        help()


if url and module == 'Domain':		
	domain.main(url)

elif url and dict and errorkey and save_path and thread and module == 'Dir':
	# dir_scanner = Dir(url,dict,errorkey,save_path)
	# dir_scanner.dir_scanner()
    dir.main(url,dict,errorkey,save_path,thread)

elif url and module == 'Appscan':
    appscan.main(url)

elif url and module == 'Brute_pass':
    brute_pass.main(url)
